@using Microsoft.AspNetCore.Identity
@inject UserManager<IdentityUser> UserManager

@{
    var user = await UserManager.GetUserAsync(User);
    var roles = user != null ? await UserManager.GetRolesAsync(user) : new List<string>();
}

<ul class="nav flex-column">
    <!-- Dashboard Link for All Users -->
    <li class="nav-item">
        <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Home" ? "active" : "")"
           href="/">
            <i class="bi bi-speedometer2"></i> لوحة التحكم
        </a>
    </li>

    <!-- Admin Menu -->
    @if (roles.Contains("Admin"))
    {
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Admin" ? "active" : "")"
               asp-controller="Admin" asp-action="Dashboard">
                <i class="bi bi-shield-check"></i> لوحة المدير
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Admin" && ViewContext.RouteData.Values["action"]?.ToString() == "Users" ? "active" : "")"
               asp-controller="Admin" asp-action="Users">
                <i class="bi bi-people"></i> إدارة المستخدمين
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Pharmacies" ? "active" : "")"
               asp-controller="Pharmacies" asp-action="Index">
                <i class="bi bi-shop"></i> إدارة الصيدليات
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Doctors" ? "active" : "")"
               asp-controller="Doctors" asp-action="Index">
                <i class="bi bi-person-badge"></i> الأطباء
            </a>
        </li>
    }

    <!-- Secretary Menu -->
    @if (roles.Contains("Secretary"))
    {
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Patients" ? "active" : "")"
               asp-controller="Patients" asp-action="Create">
                <i class="bi bi-person-plus"></i> إضافة مريض
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Patients" && ViewContext.RouteData.Values["action"]?.ToString() == "Index" ? "active" : "")"
               asp-controller="Patients" asp-action="Index">
                <i class="bi bi-people"></i> قائمة المرضى
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Visits" ? "active" : "")"
               asp-controller="Visits" asp-action="Create">
                <i class="bi bi-calendar-plus"></i> إضافة زيارة
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Visits" && ViewContext.RouteData.Values["action"]?.ToString() == "Index" ? "active" : "")"
               asp-controller="Visits" asp-action="Index">
                <i class="bi bi-calendar-check"></i> جدول الزيارات
            </a>
        </li>
    }

    <!-- Doctor Menu -->
    @if (roles.Contains("Doctor"))
    {
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Doctor" ? "active" : "")"
               asp-controller="Doctor" asp-action="Dashboard">
                <i class="bi bi-clipboard-pulse"></i> زيارات اليوم
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Doctor" && ViewContext.RouteData.Values["action"]?.ToString() == "MyPatients" ? "active" : "")"
               asp-controller="Doctor" asp-action="MyPatients">
                <i class="bi bi-people"></i> مرضاي
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Prescriptions" ? "active" : "")"
               asp-controller="Prescriptions" asp-action="Create">
                <i class="bi bi-prescription"></i> وصفة جديدة
            </a>
        </li>
    }

    <!-- Pharmacist Menu -->
    @if (roles.Contains("Pharmacist"))
    {
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Pharmacist" ? "active" : "")"
               asp-controller="Pharmacist" asp-action="Dashboard">
                <i class="bi bi-capsule"></i> لوحة الصيدلي
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Prescriptions" && ViewContext.RouteData.Values["action"]?.ToString() == "Index" ? "active" : "")"
               asp-controller="Prescriptions" asp-action="Index">
                <i class="bi bi-prescription"></i> الوصفات
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link @(ViewContext.RouteData.Values["controller"]?.ToString() == "Medicines" ? "active" : "")"
               asp-controller="Medicines" asp-action="Index">
                <i class="bi bi-capsule"></i> المخزون
            </a>
        </li>
    }
</ul>